<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2020a"><title>Solving linear least squares problems and linear regression</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: center;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: bold; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement,.eoOutputWrapper .matrixElement {min-height: 18px; box-sizing: border-box;}
.embeddedOutputsMatrixElement .matrixElement,.eoOutputWrapper .matrixElement,.rtcDataTipElement .matrixElement {position: relative;}
.matrixElement .variableValue,.rtcDataTipElement .matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement.rightPaneElement {}
.rightPaneElement .matrixElement,.rtcDataTipElement .matrixElement {overflow: hidden; padding-left: 9px;}
.rightPaneElement .matrixElement {margin-bottom: -1px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer,.eoOutputWrapper .matrixElement .valueContainer,.rtcDataTipElement .matrixElement .valueContainer {white-space: nowrap; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide,.eoOutputWrapper .matrixElement .valueContainer .horizontalEllipsis.hide,.eoOutputWrapper .matrixElement .verticalEllipsis.hide,.rtcDataTipElement .matrixElement .valueContainer .horizontalEllipsis.hide,.rtcDataTipElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsVariableMatrixElement .matrixElement .valueContainer.hideEllipses .verticalEllipsis, .embeddedOutputsVariableMatrixElement .matrixElement .valueContainer.hideEllipses .horizontalEllipsis {display:none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis,.eoOutputWrapper .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.eoOutputWrapper .embeddedOutputsVariableMatrixElement .matrixElement .valueContainer {cursor: default !important;}
.embeddedOutputsVariableElement {white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.embeddedOutputsVariableElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .variableElement {padding-top: 2px; padding-left: 9px;}
.variableNameElement {margin-bottom: 3px; display: inline-block;}
.matrixElement .horizontalEllipsis,.rtcDataTipElement .matrixElement .horizontalEllipsis {display: inline-block; margin-top: 3px; width: 30px; height: 12px; background-repeat: no-repeat; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAJCAYAAADO1CeCAAAAJUlEQVR42mP4//8/A70xw0i29BUDFPxnAEtTW37wWDqakIa4pQDvOOG89lHX2gAAAABJRU5ErkJggg==");}
.matrixElement .verticalEllipsis,.textElement .verticalEllipsis,.rtcDataTipElement .matrixElement .verticalEllipsis,.rtcDataTipElement .textElement .verticalEllipsis {margin-left: 35px; width: 12px; height: 30px; background-repeat: no-repeat; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAZCAYAAAAIcL+IAAAALklEQVR42mP4//8/AzGYgWyFMECMwv8QddRS+P//KyimlmcGUOFoOI6GI/UVAgDnd8Dd4+NCwgAAAABJRU5ErkJggg==");}
.S12 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S14 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S15 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Solving linear least squares problems and linear regression</span></h1><div  class = 'S1'><span>The linear least squares problem is</span></div><div  class = 'S2'><span texencoding="\min_w \| y - X w \|_2^2" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="93.5" height="29" /></span></div><div  class = 'S1'><span>where </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">y</span><span> is a given </span><span texencoding="n \times 1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEUAAAAkCAYAAADfJffWAAADfUlEQVRoQ+3YWchuYxjG8d82xIEpHHBiKnPGTIWcINMBOTATipyYZYoTGTOlUFJK5rnIlFkJGYsDJI4cSJExGbt0v1rW/vZ+n2+/q2/v7PWcrHrfZ7jXv+u+r/tZi4xjMQKLRiaLExihzKGKEcoIpa1YjEoZlTIqpUtgG1yOd3DjNDT/9/TZGpfhGKyCi3DtygplHVyA9bEj9ikQKzWU1fAH/sLueHtFhbIRrsDZ+GmahDv/74BTcS7+nMe6ydRN8eWKCuUZHIRXcWgjmEj/RWyI03HH8oYSCW6LXfAmPq2A1sIB2BJP46PGQDfBK9gcr+GQKWC6QO7BSctTKUfhfES2a1QgG+Nr7IX76sXCImmwGb5pBBMpB0zWLA3MTqWQDeq8E6tGNB7zn2mDpc+aeBb74Q3sjX1xFc5EfD9wMnbDu/OINkEmhfJ8HQf3FLMzXkCAPIDjZwCSsAaDks3ewh7l7U/g9qoFv+BAPFcg1sX384CSqVFKFDMBk1T6sVI1QGKlD+HYGYEMCmW9SolVsStuQyT8Wb18nOAGfFKqmSeTf6antgRMak0UcykCP0AeqYbr92XZuLdmMKUcgcfwOR4vn3+4c1gK33G4BWfNEHgXzGSbnJu6NgSQQZUSZZxRMD7Eab0X/wopvrHWONAs4/ACnz2+KwXlOdQYTCmx31juz/UMhMnYvmz415J65izr6LrMb1h9nn1My7mDQOlucg0u7p2cdLm5LHP/lqiWMCd9yEvlMkmZS/B81ZiWPqb16EGgpKW+s9efdAN4EofhQlzXGllvXrcxexRHVw3p1pihwAwCJb1BCl2CSp/SHXGjb7F2XbTyfeLkcosfGgF1gaR4x3a7RbVv1/0+pvGYf6fNDCXfV9K55q5xTqVJN4g0Vu8jvUqu5wl4q7LnlmDTJSdlsn/6kDjYXC4TMC9XPxO7nvQxLWf052yHj+vHpOjV0zbpf2TKPee9WrQFvuhtEJnfXwX4VqTzTYfbMrpAHiwgud4vaXSvBLOAOQ/X1yFpJU6YFmwfSj7MpE58UN1lf31s+KmyzbvrjtTaT2RdLDxQE9jSgEzODZgoJrXmFNw17YU6/+eL256lsu57piYm7e+tPmyxLRfyc2SuA3GuKxuBTIJNx3skbpoHkJmmLiSUmQJdyMUjlDloj1BGKG1JOCplVMqolDYCo1LaOP0NQdbKJaymoigAAAAASUVORK5CYII=" width="34.5" height="18" /></span><span> vector, </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> is a given </span><span texencoding="n \times m" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAAkCAYAAADB7MdlAAAE00lEQVRoQ+2YZahuRRiFn4vdYqCCDTZ2t2AHBoId2IWtWOAfMbEQDMRC7BZbbMHCLrDjh4WdiMkja1/mbM53zp7Pw/m158/HPfudd2bWrHe9a+4U+tEZgSmdI/tAerAqSNCD1YNVgUBFaM+sHqwKBCpCe2b1YFUgUBHaM6sHqwKBitDJZNb8wGnAUcAvFXtcHtgPOAb4u2LehIdOJlgPAFsATwJbdwRsBeBRYB7gIODyCUegIuFYYE0LLAOsDDwHvJu8swKbAksA9wNvdlxvYeAJYDHgKWCrcQArgboO2LuCWZ5r0ezdc9xS7HE9YEPgLeCu1t5dc1vgS+Aq4K/y+2hg7QwcB0j/GbLBBYCvgLWAG3Jg81hOburrjoAtEsCcMxZgK4ZRc2e9vdobH7CepX42sA0wV2JOTfnPBlwG7FbM3ShM908nAWcU344Fzh8PLL/PCDyYG3gGWBdYP8mOAJbOIYxdDXipI1iGCZil6O/TwJYthq0EPAII1E3AHh2BKrewXcGaNYHXgfuAO4C7UyUzAV6CrD0XmB44M+eWKNcA+3QBy5jngTWAE7PwpdGa34DNgIeSaA7gxwqwDJVZlmQDmCX5c8pGoGSFpSMLRpRCx3X2Ba4EvgXmA67N4R9ObivBqlolkuIZTknuD1M5Jwe8qUsO0qw5U1rTJOEluYX3MtPOdB7wTljW8QwjwtQuAVPLZJibVUME6jZgV+DPYRIDFwGHh5nq7czFwdUk2fVNLv34XMo/AfaLrLk68GIXZu0Qyn4A3Am8ANxaTJS6u2dTRw55IKeVgDVpLBV1c1igzGPZWUpq0OIFGH6z5NSjmwEB2r+QgZ3ydxk5b7uhDGKWTDokIL0GHNgC5DNA0dcC2BH/z9g+F2KO7wOgv8MOy65hx7PRxB+KZF68rJEIhwKWZjOacysBXtiIMQgsbYLW4Nf8Ck4zlotd+D0lY8ywo+x6fwDTVfqw0dZV567PB+XigiLIjvgdoLw8BmzcSvB27NIBwBVdwFJ0P07gWWmp5TzL7sK09k2GRQnQ07hhu56lp6B6y2pYFx82aGn9kV1Mr2SZ25CasXm6nf9ua1LJSBvQJ13A8mkhqj4tGn9VzrsnPuYE4JwhwSoN5+3ALtGoUsOGBexTYKHszT2W4/Rcyhu5rPJbo1dW1VKjnWu0MtTbWK9uVqdbDukrjaVzczPeot3rp47AlUDZNCybUszbtqLtw8ZaZtk4c2PWzsujjLfr6uA1rlqicjR65e9haQzKhA3uv9EGy3/r1H2LHZ1yKxNqGF8JtWePeC4ZG9EFKzuUpWd+RdSOOlrXE7DH48c8YOPDxlvDPeu61dgF0+2aObPEd2k+N4hdKfNpE1bN5en19Gl7AlObQxss34EvJ4Mt96PW7iyXGyP8F8fp6+i7jBIo27ZAjWU4y6dRV8A0yhrmhh3lvhp/ZafVFpSXZMX4dPN5d3XKWDfwfpmgDZYGTR16NW66DYIadm+EU1fsG7KrH3KeVkOwvbEuzlzAZJhapiv3IIOGzxf9kU81H/qyoxy+QA6Oj/LS28P9rZPzqXWftwMm879ofFLYSRXZLkA1e7U77tiyAF2YPOExkwnWhG9+shP2YFUg3oPVg1WBQEVoz6werAoEKkJ7ZvVgVSBQEfovP0IINC6Ud8cAAAAASUVORK5CYII=" width="37.5" height="18" /></span><span> matrix with </span><span texencoding="n &gt; m" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAkCAYAAAAeor16AAAEx0lEQVRoQ+2YV4ieVRCGn2AHjaKCDeyKImLvFbFrLDcq0YhiD5qoKOqFeGHvvStoFHsltigiKFYsiWjEEqNi773FxhPnLGc/d/f/vxz/TS7O3CS735mZM++8U86OoEoRAiOKtKsyFcBCElQAK4CFCBSqVwZWAAsRKFSvDKwAFiJQqF4ZWAEsRKBQfbgZuBhwG3Aq8GTh3ecI9dkB4JcR+VMB5GNzBBKzeImhAJwbWB1YB3gOeCt8LAhsB6wCPAS81tL3psApwPah90IA+UBLO22PzwOsFvG8AzwTBuYDdgTWAh4EXsoMi4/fNgKeBx5uOh0IwL2B44A1AY3/BSwFfA5sDNwCrBCGfgKWBxKr2gS1SQC5QyhNBk4D7gH+bmOow1kTdlIk3XiULQErYGXgjgDV3/8ALA38CMwf7Wb3zP56wMu5v8EYqPIjwFaRqc2ALYAzgHGRSYFU1m9krW3sJkVGmmllKnA6cDvwZ1tjQ5y/EDga+B6wFy8L3A2cCMwV7FPd338X/u8HJgHTYOYfXg4AbuwGQM9I2Q3DwX3AlcAuwC9RfhpWFo5LlcZqmQjkTmHo7UjYzcAfpcaBCcAYwFgOCqbvB3wI7AHcG3EsAgic8VqyAvp++JfNz3YDoEYsSzOzLnAFsD9gUMqxwPnAm8HG/yG+PhMmTSB3jt+8B5wF3AD8VuDo1WhLRwDbAJdlm8AFwDEBrsSw1C8OX3sFG2WlzO1XFYOV8J6RIalrZmz0d2aXlxX7ApcA4wuCGkp1gwBS1isfAecA10YVtHG7ePRw4z0Z+BkQtCQvAvY3W5QVdWT2TfIIuswVl34yGIBJSeCmAIc29D6OwWJwTuJeiUywlA7MHFwNHN7SYc4iJ63JTzIS+DqqzUHmdvBF9t2e7DYyNu7SFYCuLK4pZsp/BSzJGrG6WE6LxpmW8XQ8LnCHRP9dJqayDHBK95uCHS39e+CasOf/m0PPnptIIDv1kWQJ4NP4QRxcfzoCuBxg31HsPa4AuViyFwGPA9t2GUC3x5z+CTjXCfuNa4ZT+fVujQxw7t1YvSYCuzW+nxmJ+gxYCXA1S5KYKx5pdesIoBPqusb+lyt5iV2BE6InFcTVpypwtgltCtwM4CbA4P6T9ZYOBSXZcDA1l+GnAafrpbGi5eZTK5PBhw3kd6Ae6FvVZdq3qntgLk7lb4CFAJu8zdf+dFcsoS1jY4EMOJd128L1wNnAB22NDXLe3nV53M9h8nt2Tv/fAvPG+uTum0vqfzLRIeq648urL6lNAP3ZF4eOHOuWai5rA6/EFLT52j9WjZWmTbxe3IzKuCWjbBwO5wGftDHUxVl3Osv2VmB047xP0kejj7ui/Jp9lySuLmJiH7a1WZ0H5zaaAPruTU16RWB6w+E+cRGHi1m19HyZdCsy+KgMOC/oPmaiZuU52Mmv718nrO/3xKJcJ+1/vsNHNYxtHs89n5XnRn90Fzb2PmkCeHz0Nce5YDbFMtOZDdXN3jdzm1eCWRaorwI0+44g9kq2Bp6I1mBV+cbN5Y14CLjnXdX45gS2P0oSZ4I7Yl7+M48P95+zLHuHhZdtBtMrEHtqd7gB7Gkws8N4BbAQ9QpgBbAQgUL1ysAKYCECheqVgRXAQgQK1f8B9U/wJTrMtCoAAAAASUVORK5CYII=" width="40" height="18" /></span><span>, and </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">w</span><span> is a </span><span texencoding="m \times 1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAAkCAYAAADB7MdlAAAEFElEQVRoQ+3YachtUxzH8c8lJSmROWNCKKHMUjJPJTK+MM8vDBleyCwvKEKZh0wRGTIlQ1LmDK+EJDMZIrPM+l1r1767e87Z++xz697s/6vzPGvtNXzXf/itNcdgrQnMad1z6GiA1cEJBlgDrA4EOnQdPGuA1YFAh66DZ7EzLsBJeG0cu/8zrB0LpG0LoK3wygBrXgIb4Rj8g32xxgBrtIssgT9K8xm4dFGDlXzxCR7smG8vwb2Tcs2YMQ/DrYsSrC3xcjntA1sCS669FsfhI6yH3zuArrrODNbS2Bib4CF8VmZYHnthVdyCL2qLXBLZ8Nq4D2+23MA5uLAAOwgPjPkuoK7Dsfjef9Xs1ZbzNLv1hnU4jsfmWAy/YDn8ht1wO1Yosz6LHcrvNfFkOeX862usXr5rs5dzS3VKPhkFLKCuLwn6B+wyqYJNmLg3rGr8N7ApHsce2Aen4ERkkjPxPtbBhrgJ2XBA3lUGWauESRtY6XMezsefxUPrHhZQN+Bo/FhAJXz72MxgfVw8I4BeLCD2K7nhCpyMhxFPfLrATJI+FLfhZyxbqzxtNxWBGOgBFg+7n7mvIzfiqAIqHp419bWZwErYfVNWsgUCJ56V0IpVXheQ8b7kkOqUr8EJeKzktmk2lPyVPBZgh5TwPxI/ld8vTDPofL6ZCayItZxoKk02fUcNxjL4tuSzs/Fp8aRqLW9hgxKyV/bY1EXI+JXFU3fHcz3GbH46E1iVd3xQEmr0TGXJXwEYYPGmPWttK9WqY/LY2z02ltB7vXhuhkl4Jp/N0mYC612siy+LDPi1tsKAS3KPbd846QNwT5EZq/XYVb3qpTpWqrutDms7dW9YuSsl/GKn4fLGzC8hl85HsXejrfLIqOIj2q640a+uoxJ68eRoqYTkOFkxzXS9YaXiRAZkYSviu9oqlip/56RTGZviscpXScp3T7H6Oqgk84CqclSV9GcJrDes3LX2xxOl8tT3nGeNyIQsOEo+wrCygE3YxpK7vsKpuAp/tQBXv8IEVJL5843v6rIiITlO6beYcq5enPpuuHiRB9FHuXdFBNbtYpyFZxBwdcsV6BEk361fHtOi+qO4J1lAJYRzc4jgDKhR8iBJPuK1rsMmjT+qPQL76tK4DZJiRlrz8W/rIvb+Lne/ylOqASp9dToua4yanJJy/yGeKp5VL/2jFtEEteukRTeUfiVcpwEWUV3l3dwMbu4Cqzq1nOp2jQ9XxudFTUdHvdNozz3tzgIpHtg2Z+XVIWo8oRdQba8w1V3yPeRBr+2rwypFA+6EzWp7SDFJJc94KWqJinlsYXlWPrjcM8c+687n1PMOltCPHlzgtrDAWuAbncUEA6wOFAdYA6wOBDp0HTxrgNWBQIeug2cNsDoQ6ND1X0CX8yUyxZ+qAAAAAElFTkSuQmCC" width="37.5" height="18" /></span><span> vector to be determined. This problem arises in linear regression and countless other applications.</span></div><div  class = 'S1'><span>Assume that </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> has a linear independent set of columns. Then, one way to solve for </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">w</span><span> is to solve the </span><span style=' font-style: italic;'>normal equations,</span></div><div  class = 'S2'><span texencoding="X^T X w = X^T y" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="83.5" height="19" /></span></div><div  class = 'S1'><span>which is a linear system of </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">m</span><span> equations and </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">m</span><span> unknowns that can be solved via Cholesky factorization. From this equation, the vector </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">w</span><span> can be written explicitly as</span></div><div  class = 'S2'><span texencoding="w = (X^T X)^{-1} X^T y" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="108" height="19.5" /></span></div><div  class = 'S1'><span>which can be called the </span><span style=' font-style: italic;'>formal solution</span><span> to the least squares problem.</span></div><div  class = 'S1'><span>It is essential to point out whenever introducing the normal equations that solving the least squares problem this way is not numerically stable, and thus not guaranteed to give an accurate answer, due to accumulation of roundoff error in a computer calculation. A numerically stable way to solve the least squares problem is to use QR factorization.</span></div><div  class = 'S1'><span>Thus you should never solve the least squares problem via the normal equations unless you understand the risks. The formal solution is often written down as the least-squares solution when working analytically where numerical computations are not being performed, but it is just that: a formal solution, but not one intended for computations.</span></div><h3  class = 'S3'><span>Example</span></h3><div  class = 'S1'><span>We now show an example of the differences you obtain in the answers when you solve the least squares problem using the normal equations and using QR factorization.</span></div><div  class = 'S1'><span>First generate a matrix </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> of size </span><span texencoding="n \times 2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEUAAAAkCAYAAADfJffWAAAENklEQVRoQ+2YWahWVRTHf5JSRlaYmL6kRYMSaYVmEGFB8wBFhGMOGUkPpalNRk+NRNEAFURQRDQPRmGZQ6kYFs34kgP1UEESFI1EI79YX+zOPec7+3g/bnA56+Vw71l777X/31rr/19nCK31QWBIi0lfBFpQSrKiBaUFJa9ZtJnSZkqbKYcD1wHHAhOAL4BPgPuAt7vBM1jL57K4/L4ll/8LuAu4tgqYwQjKCZEJa4CngK+Bw4ALgTMTIC4Gni8DZjCCsg14Cbip5MLLgLvj/59GWf2vinYMcDOwFPgpr+X943UMsAjwQn/WrJsMPAycCFgmRTMJ3gGmxvsDgB/KnBrE1y/X14CzgI3AuZnATALWA6OAxXHhbkFcD3wMeFaV3QlcEy+PAHY2AWUoMBE4DtgKbI/F+wGnA264GjBdc+wQ4C3gUGATcE4NMCkgTwDzMzLFTCjLkDS+K4H7w2848GsOKDOAFZG2e0cgY4HdkZZPxsXcyzIYD3yTgwowLoBxTTdgLAMz5CDA8+YBf2SeUed2K7Ay4ji1zLmq0e4DvA5Mj05+EnAycBtwVTQog9WmAO/XRZK8FxhLyOdm4OxCxqgr1gUgTwNzewiIYXTKeCbwTBNQ9LUhSW/W6SrgoegFvwBnAFKeZrP6vgEoupopllIHGEvpxyhVARkJPAvM7jEgNntF3BbglKpSq8qUA6Mk9gKOBx6MFN4Rl+9QWyWtZYBkbxEYe40Zc2OALyDqh1nA7xn7NHFRzS6I7O7cpc/6KlAUOi8Cu4Lz3wWeS1bb+OZEw1rSJKqCbwpM55Xn2td6DYhZbx87H1jbLeYqUMyMKwDBkOIuL2zyFWDzlVploP7YBQG8e3wXTdxnL210MKg66dG6jatAkX6l3J/jKQgdOzpoWCoz1fXZU0tZ5jdgWEMdk3OutPtmSH7Lp9bKQLH5fR4r7wBuKOxiudwblHla7QnVDuqQDcEylow0+Ub0mBwdk3O0ICv5bay35yzQpwwUJfUjBX2S7vcKcF6M5arDPbFUmL0ASI/2kLTH9BcYSUJKN+tt4lV2cAyN/74vA8WNbHQGpU5JzYO+BUbE/PAesDDYos8MURFFCojNW9pNm2qRros6JudH8F6PRY/qRgROykcBt6SbFkHxb5Wrs8bVUSapv8LqQ0Ctsn8IryOTybMuYIc7S8b91SEyWBnLCIx9wKd03dExdft33quppkU2lw2RjjD+OE7SjjJfdgPFOeeDcPAbxGeFKExzv1HYXB8AVL4q3BxLAVFJCkg36Z6OBE2A8QPS8pyAgJcB2e8/VswUp0f7xEehLov+0vCrUfuPx4yUqydcJ4UL6iWZSlVgzBh7zaUZdJp+L8nBpVRSDORHJscB69uBrMlwp+K9CLgn55a98BlIUHoR74Ds0YJSAnMLSgtKXvW1mdJmSpspeQi0mZKH09/sq9olr7n7PQAAAABJRU5ErkJggg==" width="34.5" height="18" /></span><span>. Ignore how this matrix is generated for now.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>rng(0)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>n = 10;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>X = rand(n,1)-.5;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>X = [X X+rand(n,1)*1e-8];</span></span></div></div></div><div  class = 'S7'><span>Since we want to compare the answers from our numerical computations, let's set up the problem so that we know the true </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">w</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>w = [1 2]';</span></span></div></div></div><div  class = 'S7'><span>Generate the vector </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">y</span><span> with this known solution.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>y = X*w;</span></span></div></div></div><div  class = 'S7'><span>Now we are ready to solve using the normal equations</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>format </span><span style="color: rgb(160, 32, 240);">long</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S9'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'Solution using normal equations\n'</span><span>);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="23FB7448" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-height="18" data-hashorizontaloverflow="false" data-testid="output_0" style="max-height: 261px; width: 796px;"><div class="textElement">Solution using normal equations</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre;"><span class="warning_squiggle_rte1575067350">w</span><span> = (X'*X)\(X'*y)</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="710C9CE3" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-height="18" data-hashorizontaloverflow="false" data-testid="output_1" style="max-height: 261px; width: 796px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.921069e-16.</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsVariableMatrixElement" uid="96EFAFAA" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-testid="output_2" style="width: 796px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="matrixElement veSpecifier saveLoad" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="veVariableName variableNameElement double" style="width: 766px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="headerElementClickToInteract" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><span style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">w = </span><span class="veVariableValueSummary veMetaSummary" style="white-space: normal; font-style: normal; color: rgb(179, 179, 179); font-size: 12px;">2×1</span></div></div><div class="valueContainer" data-layout="{&quot;columnWidth&quot;:140,&quot;totalColumns&quot;:&quot;1&quot;,&quot;totalRows&quot;:&quot;2&quot;,&quot;charsPerColumn&quot;:20}" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="variableValue" style="width: 142px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">   0.895865132745946
   2.104134866327875
</div><div class="horizontalEllipsis hide" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div><div class="verticalEllipsis hide" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div></div></div></div></div></div></div><div  class = 'S7'><span>and using QR factorization</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S12'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'Solution using QR factorization\n'</span><span>);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="B000C2D0" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-height="18" data-hashorizontaloverflow="false" data-testid="output_3" style="max-height: 261px; width: 796px;"><div class="textElement">Solution using QR factorization</div></div></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>[Q, R] = qr(X,0); </span><span style="color: rgb(60, 118, 61);">% Q is n by 2</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S9'><span style="white-space: pre;"><span class="warning_squiggle_rte1575067350">w</span><span> = R\(Q'*y)</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableMatrixElement" uid="BD4E4ECF" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-testid="output_4" style="width: 796px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="matrixElement veSpecifier saveLoad" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="veVariableName variableNameElement double" style="width: 766px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="headerElementClickToInteract" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><span style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">w = </span><span class="veVariableValueSummary veMetaSummary" style="white-space: normal; font-style: normal; color: rgb(179, 179, 179); font-size: 12px;">2×1</span></div></div><div class="valueContainer" data-layout="{&quot;columnWidth&quot;:140,&quot;totalColumns&quot;:&quot;1&quot;,&quot;totalRows&quot;:&quot;2&quot;,&quot;charsPerColumn&quot;:20}" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="variableValue" style="width: 142px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">   0.999999994878468
   2.000000005121533
</div><div class="horizontalEllipsis hide" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div><div class="verticalEllipsis hide" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div></div></div></div></div></div></div><div  class = 'S7'><span>Observe that the solution using the normal equations can be quite inaccurate, while the solution via QR factorization is much more accurate. Although the solution methods are </span><span style=' font-style: italic;'>mathematically</span><span> equivalent, they are </span><span style=' font-style: italic;'>numerically</span><span> different. This phenomenon occurs not just for least squares problems but for all problems that are solved on a computer with floating point computations. We must avoid numerically unstable methods that tend to incur large amounts of roundoff error that can spoil an answer. The study of stable and unstable algorithms is a major part of the field of Numerical Analysis.</span></div><div  class = 'S1'><span>Returning back to our example, if the matrix </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> has more rows than columns, which is the setting of our least squares problem, then the </span><a href = "https://www.mathworks.com/help/matlab/ref/mldivide.html"><span>backslash operator</span></a><span> in MATLAB will automatically return the least squares solution (using a stable method).</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S12'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'Solution using Matlab\n'</span><span>);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="1B867B11" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-height="18" data-hashorizontaloverflow="false" data-testid="output_5" style="max-height: 261px; width: 796px;"><div class="textElement">Solution using Matlab</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre;"><span class="warning_squiggle_rte1575067350">w</span><span> = X\y</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableMatrixElement" uid="95D59086" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-width="766" data-testid="output_6" style="width: 796px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="matrixElement veSpecifier saveLoad" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="veVariableName variableNameElement double" style="width: 766px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="headerElementClickToInteract" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><span style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">w = </span><span class="veVariableValueSummary veMetaSummary" style="white-space: normal; font-style: normal; color: rgb(179, 179, 179); font-size: 12px;">2×1</span></div></div><div class="valueContainer" data-layout="{&quot;columnWidth&quot;:140,&quot;totalColumns&quot;:&quot;1&quot;,&quot;totalRows&quot;:&quot;2&quot;,&quot;charsPerColumn&quot;:20}" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="variableValue" style="width: 142px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">   1.000000000984840
   1.999999999015160
</div><div class="horizontalEllipsis hide" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div><div class="verticalEllipsis hide" style="white-space: nowrap; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div></div></div></div></div></div></div><h3  class = 'S3'><span>Taking it further</span></h3><ol  class = 'S14'><li  class = 'S15'><span>Experiment with different ways of generating the matrix </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> and observe how the numerical least squares solutions compare when using the normal equations and using QR factorization. Explain in what cases the normal equations solution is accurate.</span></li><li  class = 'S15'><span>What happens if the columns of </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> are not linearly independent? How do the three numerical solutions above compare to the true solution? What is the residual </span><span texencoding="r=y-Xw" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="73" height="18" /></span><span> for the different numerical solutions </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">w</span><span>? Note that the residual can be small for different </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">w</span><span>, suggesting that they are all possible solutions.</span></li><li  class = 'S15'><span>We did not explain the linear least squares solution method that uses QR factorization. Investigate this method as well as what should be done if </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> does not have linearly independent columns.</span></li></ol><h3  class = 'S3'><span>Linear regression</span></h3><div  class = 'S1'><span>Now that you know how to solve least squares problem in a stable fashion, let's use it to solve a simple 1-dimensional linear regression problem.</span></div><div  class = 'S1'><span>Here is an example using three data points.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>x = [1.0 2.0 3.0]';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>y = [5.1 6.2 7.1]';</span></span></div></div></div><div  class = 'S7'><span>Set up the matrix </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: normal; color: rgb(0, 0, 0);">X</span><span> for linear regression.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>n = length(x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>X = [ones(n,1) x];</span></span></div></div></div><div  class = 'S7'><span>Solve the least squares problem.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>w = X\y;</span></span></div></div></div><div  class = 'S7'><span>Plot the data and the linear regression line.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>clf</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>plot(x,y,</span><span style="color: rgb(160, 32, 240);">'o'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>fun = @(x) w(1)+w(2)*x;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S9'><span style="white-space: pre;"><span>fplot(fun, [0 4]);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsFigure" uid="B854C68A" data-scroll-top="null" data-scroll-left="null" contenteditable="false" data-testid="output_7" style="width: 796px;"><div class="figureElement"><img class="figureImage figureContainingNode" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAAGkCAYAAAAv7h+nAAAgAElEQVR4AezBXagdVr327d8aEkIkLyF45Kjl0aLjPjAvtpOCRlnaFRUKVRLJELIhFN0QsJacJDkIIkJp8USiiGBBEGotbcAhbPVApJgIsdQQOwmRuvmPUtgedCBIug4K/TBt8z7r2W95umub9CNZa8057+tKl83MzMxmTMLMzMxsxiTMzMzMZkzCzMzMbMYkzMzMzGZMwszMzGzGJMzMzMxmTMLMzMxsxiTMzMzMZkzCzMzMbMYkzMzMzGZMwszMzGzGJMzMzMxmTMLMzMxsxiTMzMzMZkzCzMzMbMYkzMzMzGZMwszMzGzGJMzMzMxmTMLMzMxsxiTMzMzMZkzCzMzMbMYkzMzMzGZMwszMzGzGJMzMzMxmTMLMzMxsxiTmzCuvvIKZmZnNt8Sc+M1vfsPnP/957rrrLj772c/ywx/+kLeye/duJpMJk8mEyWTCZDJhdXUVMzMzmw2JOXDx4kWOHz/Oz3/+c37yk5/w6KOP8stf/pIzZ87wZp599lkef/xxptMp0+mU6XTKzp07MTMzs9mQmAN///vfWVpaIufMmq1bt/LRj36U1dVV3ujSpUus2bp1K2ZmZjabEnPg4x//OLt27eLHP/4xYwx+/etf89RTT/GZz3yGN3rxxRfZsmULDz30EMeOHeP48eNcuHCBK5GEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQhCUlIQhKSkIQkJCEJSUhCEpKQhCQkIQlJSEISkpCEJCQxbxJz4q677uLkyZPcd999/OhHP+IrX/kKH/jAB3ijp59+mh07dvDCCy+wd+9edu3axZ133smFCxe4koggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIYE1EEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRLAmIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICJYExFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRARrIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCNRFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRwZqIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKI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goggIrgTZfwDHTp0iGeeeYa1a9fy/1BRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUbnTZPzDjI+Pc/HiRZ5//nmSJEmSJCmmjH+Yjz/+mHPnzlGpVKhUKhw6dIhPPvmEbdu2kSRJkiRJMWT8wwwPD/PDDz8wOTnJ5OQk+/bto7e3l9OnT5MkSZIkSTFkJEmSJEmSFEzGP1x/fz+vvfYaSZIkSZIUR0aSJEmSJEnBZCRJkiRJkhRMRvKXarUaRVer1UiSv6tarUbR1Wo1/klqtRpFV6vVSIotI7mt77//nk2bNvHEE0/w2GOPcerUKYrm+++/Z9OmTTzxxBM89thjnDp1iv+mvb2dcrlMuVymXC5TLpdZXFykSEZHR9m4cSOnT5+myEZHR9m4cSOnT5/mr7S3t1MulymXy5TLZcrlMouLixTF2NgYXV1dVCoVWltbOXLkCEUzNjZGV1cXlUqF1tZWjhw5wn/T3t5OuVymXC5TLpcpl8ssLi5SJCMjI2zcuJFKpUK5XObdd9+laEZGRti4cSOVSoVyucy7777Lf9Pe3k65XKZcLlMulymXyywuLlI0V69eZdu2bfz73//mTpKR3KJWq7F7925ef/11Jicn+eyzzzh8+DDnz5+nKGq1Grt37+b1119ncnKSzz77jMOHD3P+/HluZ2FhgTNnzpDnOXmek+c5q1evpiiOHDnCyMgI999/P7VajaI6cuQIIyMj3H///dRqNf7KwsICZ86cIc9z8jwnz3NWr15NEVy6dInBwUHeeOMNpqen+fLLL/noo48YHx+nKC5dusTg4CBvvPEG09PTfPnll3z00UeMj49zOwsLC5w5c4Y8z8nznDzPWb16NUVx8eJFXn75Zd577z2mp6cZHR3lgw8+YHJykqK4ePEiL7/8Mu+99x7T09OMjo7ywQcfMDk5ye0sLCxw5swZ8jwnz3PyPGf16tUUzZtvvsmKFSu4evUqd5KM5BbffPMN9957L5VKhbqWlhY6Ozv5/PPPKYpvvvmGe++9l0qlQl1LSwudnZ18/vnn3Gx5eZm6hoYGimrz5s288847NDU1UWSbN2/mnXfeoampib+yvLxMXUNDA0WUZRnDw8O0tbVR19zczMMPP8zi4iJFkWUZw8PDtLW1Udfc3MzDDz/M4uIiN1teXqauoaGBorrnnnt4//33iQjqWlpaWL9+PfPz8xTFPffcw/vvv09EUNfS0sL69euZn5/nZsvLy9Q1NDRQZFNTU5w9e5bt27dzp8lIbrGwsMC6deu40SOPPMLvv/9OUSwsLLBu3Tpu9Mgjj/D7779zsytXrrBy5UqOHz/O0NAQe/fuZWZmhiJ56KGHuBM89NBD/D+uXLnCypUrOX78OENDQ+zdu5eZmRmKorm5mU2bNnHd3Nwc3333HRs2bKAompub2bRpE9fNzc3x3XffsWHDBm525coVVq5cyfHjxxkaGmLv3r3MzMxQJC0tLbS1tVFXq9X44osvOH/+PJVKhaJoaWmhra2NulqtxhdffMH58+epVCrc7MqVK6xcuZLjx48zNDTE3r17mZmZoUguX77Mv/71L958803uRBnJLWq1GlmWcaPGxkaWlpYoilqtRpZl3KixsZGlpSVuduHCBZqamlhaWqKnp4dSqcSOHTuYmZkh+Xu6cOECTU1NLC0t0dPTQ6lUYseOHczMzFA0c3Nz7Ny5k1deeYU1a9ZQRHNzc+zcuZNXXnmFNWvWcLMLFy7Q1NTE0tISPT09lEolduzYwczMDEUzOjrKhg0b2LdvH6+++irNzc0UzejoKBs2bGDfvn28+uqrNDc3c7MLFy7Q1NTE0tISPT09lEolduzYwczMDEVx6NAhnnnmGdauXcudKCO5xV133cWff/7JjZaWlrj77rspirvuuos///yTGy0tLXH33Xdzs9bWViYmJti1axcdHR1s376dLVu2cOLECZK/p9bWViYmJti1axcdHR1s376dLVu2cOLECYokz3MGBgZ46aWX6Ovro4jyPGdgYICXXnqJvr4+bqe1tZWJiQl27dpFR0cH27dvZ8uWLZw4cYKi2bx5MzMzM3z66accPnyYkZERimbz5s3MzMzw6aefcvjwYUZGRrhZa2srExMT7Nq1i46ODrZv386WLVs4ceIERTA+Ps7Fixd5/vnnuVNlJLe47777+PXXX7nRTz/9xLp16yiK++67j19//ZUb/fTTT6xbt47bWV5e5karVq3i2rVrJH9fy8vL3GjVqlVcu3aNovjxxx8ZGhpieHiY7u5uiujHH39kaGiI4eFhuru7+SvLy8vcaNWqVVy7do2imJ2dJc9zrluzZg2VSoWvv/6aopidnSXPc65bs2YNlUqFr7/+mttZXl7mRqtWreLatWsUwccff8y5c+eoVCpUKhUOHTrEJ598wrZt27hTZCS3ePLJJ/njjz/49ttvqbt06RLj4+Ns3bqVonjyySf5448/+Pbbb6m7dOkS4+PjbN26lbqpqSlmZ2epGx8fp7Ozk/n5eeoWFxcZGxujvb2d5O9jamqK2dlZ6sbHx+ns7GR+fp66xcVFxsbGaG9vpwguX77M7t27eeutt1i/fj1FdPnyZXbv3s1bb73F+vXrudnU1BSzs7PUjY+P09nZyfz8PHWLi4uMjY3R3t5OUfz222+88MILzM3NUXf16lV+/vlnHnzwQYrit99+44UXXmBubo66q1ev8vPPP/Pggw9SNzU1xezsLHXj4+N0dnYyPz9P3eLiImNjY7S3t1MEw8PD/PDDD0xOTjI5Ocm+ffvo7e3l9OnT3CkyklusWLGC4eFh9u/fT29vL1u3bmVoaIgHHniAolixYgXDw8Ps37+f3t5etm7dytDQEA888AB1R48eZXp6mrqOjg4GBgbo6uqip6eHrq4uuru76evroyhKpRKlUomvvvqK/fv3UyqVOHDgAEVTKpUolUp89dVX7N+/n1KpxIEDB6g7evQo09PT1HV0dDAwMEBXVxc9PT10dXXR3d1NX18fRTAxMcHc3BzPPvsspVKJUqlEqVTiwIEDFMXExARzc3M8++yzlEolSqUSpVKJAwcOUHf06FGmp6ep6+joYGBggK6uLnp6eujq6qK7u5u+vj6K4vHHH+e5557j6aefpr+/n7a2NtauXcvOnTspiscff5znnnuOp59+mv7+ftra2li7di07d+6k7ujRo0xPT1PX0dHBwMAAXV1d9PT00NXVRXd3N319fSR/DxnJbT366KOMjY1x6tQppqam6O/vp2geffRRxsbGOHXqFFNTU/T393PdsWPH6O3t5brBwUHOnj3LyZMnyfOcPXv2UCTVapVqtcq5c+f45ZdfqFarHDx4kKKpVqtUq1XOnTvHL7/8QrVa5eDBg9QdO3aM3t5erhscHOTs2bOcPHmSPM/Zs2cPRfHUU0+hUq1WqVarVKtVqtUqBw8epCieeuopVKrVKtVqlWq1SrVa5eDBg9QdO3aM3t5erhscHOTs2bOcPHmSPM/Zs2cPRfPiiy+S5zkffvgheZ7z9ttv09DQQJG8+OKL5HnOhx9+SJ7nvP322zQ0NFB37Ngxent7uW5wcJCzZ89y8uRJ8jxnz549FFV/fz+vvfYad5KM5C81NDSQZRlF1tDQQJZl/C9ZltHY2EiWZSTFkGUZjY2NZFlG8veXZRmNjY1kWUaRNTY2kmUZRdbY2EiWZfwvWZbR2NhIlmUkfy8ZSZIkSZIkBZORJEmSJElSMBlJkiRJkiQFk5EkSZIkSVIwGUmSJEmSJAWTkSRJkiRJUjAZSZIkSZIkBZORJEmSJElSMBlJkiRJkiQFk5EkSZIkSVIwGUmSJEmSJAWTkSRJkiRJUjAZSZIkSZIkBZORJEmSJElSMBlJkiRJkiQFk5EkSZIkSVIwGUmSJEmSJAWTkSRJkiRJUjAZSZIkSZIkBZORJEmSJElSMBlJkiRJkiQFk5EkSZIkSVIwGUmSJEmSJAWTkSRJkiRJUjAZSZIkSZIkBZORJEmSJElSMP8BTHfweGSgOfAAAAAASUVORK5CYII=" style="width: 560px;"></div></div></div></div></div><h3  class = 'S3'><span>Taking it further</span></h3><div  class = 'S1'><span>Construct a 2-dimensional multiple regression problem (i.e., fabricate the data) such that the least squares solution via the normal equations is inaccurate (but accurate via the QR factorization method).</span></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Solving linear least squares problems and linear regression
% The linear least squares problem is
% 
% $$\min_w \| y - X w \|_2^2$$
% 
% where $y$ is a given $n \times 1$ vector, $X$ is a given $n \times m$ matrix 
% with $n > m$, and $w$ is a $m \times 1$ vector to be determined. This problem 
% arises in linear regression and countless other applications.
% 
% Assume that $X$ has a linear independent set of columns. Then, one way to 
% solve for $w$ is to solve the _normal equations,_
% 
% $$X^T X w = X^T y$$
% 
% which is a linear system of $m$ equations and $m$ unknowns that can be solved 
% via Cholesky factorization. From this equation, the vector $w$ can be written 
% explicitly as
% 
% $$w = (X^T X)^{-1} X^T y$$
% 
% which can be called the _formal solution_ to the least squares problem.
% 
% It is essential to point out whenever introducing the normal equations that 
% solving the least squares problem this way is not numerically stable, and thus 
% not guaranteed to give an accurate answer, due to accumulation of roundoff error 
% in a computer calculation. A numerically stable way to solve the least squares 
% problem is to use QR factorization.
% 
% Thus you should never solve the least squares problem via the normal equations 
% unless you understand the risks. The formal solution is often written down as 
% the least-squares solution when working analytically where numerical computations 
% are not being performed, but it is just that: a formal solution, but not one 
% intended for computations.
% Example
% We now show an example of the differences you obtain in the answers when you 
% solve the least squares problem using the normal equations and using QR factorization.
% 
% First generate a matrix $X$ of size $n \times 2$. Ignore how this matrix is 
% generated for now.

rng(0)
n = 10;
X = rand(n,1)-.5;
X = [X X+rand(n,1)*1e-8];
%% 
% Since we want to compare the answers from our numerical computations, let's 
% set up the problem so that we know the true $w$.

w = [1 2]';
%% 
% Generate the vector $y$ with this known solution.

y = X*w;
%% 
% Now we are ready to solve using the normal equations

format long
fprintf('Solution using normal equations\n');
w = (X'*X)\(X'*y)
%% 
% and using QR factorization

fprintf('Solution using QR factorization\n');
[Q, R] = qr(X,0); % Q is n by 2
w = R\(Q'*y)
%% 
% Observe that the solution using the normal equations can be quite inaccurate, 
% while the solution via QR factorization is much more accurate. Although the 
% solution methods are _mathematically_ equivalent, they are _numerically_ different. 
% This phenomenon occurs not just for least squares problems but for all problems 
% that are solved on a computer with floating point computations. We must avoid 
% numerically unstable methods that tend to incur large amounts of roundoff error 
% that can spoil an answer. The study of stable and unstable algorithms is a major 
% part of the field of Numerical Analysis.
% 
% Returning back to our example, if the matrix $X$ has more rows than columns, 
% which is the setting of our least squares problem, then the <https://www.mathworks.com/help/matlab/ref/mldivide.html 
% backslash operator> in MATLAB will automatically return the least squares solution 
% (using a stable method).

fprintf('Solution using Matlab\n');
w = X\y
% Taking it further
%% 
% # Experiment with different ways of generating the matrix $X$ and observe 
% how the numerical least squares solutions compare when using the normal equations 
% and using QR factorization. Explain in what cases the normal equations solution 
% is accurate.
% # What happens if the columns of $X$ are not linearly independent? How do 
% the three numerical solutions above compare to the true solution? What is the 
% residual $r=y-Xw$ for the different numerical solutions $w$? Note that the residual 
% can be small for different $w$, suggesting that they are all possible solutions.
% # We did not explain the linear least squares solution method that uses QR 
% factorization. Investigate this method as well as what should be done if $X$ 
% does not have linearly independent columns.
% Linear regression
% Now that you know how to solve least squares problem in a stable fashion, 
% let's use it to solve a simple 1-dimensional linear regression problem.
% 
% Here is an example using three data points.

x = [1.0 2.0 3.0]';
y = [5.1 6.2 7.1]';
%% 
% Set up the matrix $X$ for linear regression.

n = length(x);
X = [ones(n,1) x];
%% 
% Solve the least squares problem.

w = X\y;
%% 
% Plot the data and the linear regression line.

clf
plot(x,y,'o');
hold on
fun = @(x) w(1)+w(2)*x;
fplot(fun, [0 4]);
% Taking it further
% Construct a 2-dimensional multiple regression problem (i.e., fabricate the 
% data) such that the least squares solution via the normal equations is inaccurate 
% (but accurate via the QR factorization method).
##### SOURCE END #####
--></body></html>